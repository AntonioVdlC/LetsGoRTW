{% extends "base.html" %}

{% load staticfiles %}

{% block slogan %}Find your way around the world!{% endblock %}

{% block css %}<link rel="stylesheet" href="{% static 'css/results.css' %}">{% endblock %}

{% block content %}

	{% if rtwResults %}
		<p id="results-text"><span class="blue">{{ rtwResults|length }}</span> itinerar{{ rtwResults|length|pluralize:"y,ies" }} found for a <span class="blue">{{ rtwResults.0.duration }}-month</span>  world tour departing from <span class="blue">{{ rtwResults.0.country }}</span>  in <span class="blue"><span id="date">{{ request.GET.date }}</span></span>  with <span class="blue"><span id="budget"></span></span>  per person.</p>

	    <ul id="results">
	    {% for rtw in rtwResults %}
		<div class="rtw-preview">
		    <a href="{{ rtw.get_absolute_url }}">
		        <li>
		        	<img class="goarrow" src="{% static 'css/img/goarrow.png' %}" alt="Go Arrow" />
		        	<section class="res">
		        		<p class="res-title">{{ rtw.title }}</p>
		        		
		        		<p class="res-description">{{ rtw.short_description | safe }}</p>
		        	</section>
		        </li>
		    </a>
		</div>
	    {% endfor %}
	    </ul>

		<p id="search-again"><a href="{% url 'index' %}">Search again?</a></p>

	{% else %}
	    <p id="no-itineraries">No itineraries are available, sorry!</p>
	    <p id="search-again-no-it"><a href="{% url 'index' %}">Search again?</a></p>
	{% endif %}

{% endblock %}

{% block scripts %}
<script type="text/javascript">
	var dates = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

	function getBudget (val, currency) {
		var str = '';

		if (currency == 'USD'){
			str = (val * 1.3) + ' ' + '$';
		}
		else if (currency == 'SGD'){
			str = (val * 1.7) + ' ' + '$';
		}
		else if (currency == 'GBP'){
			str = (val * 0.8) + ' ' + '£';
		}
		else{ //if (currency == 'EUR')
			str = val + ' ' + '€';
		}

		return str;
	}

	window.onload = function(){
		document.getElementById('date').innerHTML = dates[{{request.GET.date}}-1];
		document.getElementById('budget').innerHTML = getBudget({{request.GET.budget}}, '{{request.GET.currency}}');
	}
</script>
{% endblock %}